s
SSE=68.76
n=76
s=sqrt(SSE/(n-2))
s
SSE=68.76
n=76
s=sqrt(SSE/(n-2))
s
anova(model)
SSE=74
n=76
s=sqrt(SSE/(n-2))
s
SSE=349833
n=76
s=sqrt(SSE/(n-2))
s
s2=sqrt(sum(model$residuals^2)/74)
s2
summary(y)
length(y)
View(TAMPALMS)
View(TAMPALMS)
beta0 = 1.35868
beta1 = 1.40827
x_hat = 300
y_hat=beta0+beta1*x_hat
y_hat
s2=sqrt(sum(model$residuals^2)/74)
s2
y_length=length(y)
s2=sqrt(sum(model$residuals^2)/(y_length-2)
s2
length(y)
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2)
s
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2)
s
y_length <- length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2)
s
y_length <- length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
### Use the prop.table function to compute conditional probabilities by specifying the row (margin=1) or column (margin=2)
prop.table(q2_dat, margin=1)
restrain <- c("No", "Yes")
Injury <- c("Fatal", "Nonfatal")
dd1 <- expand.grid(restrain=restrain, Injury=Injury)
dd1
counts <- c(433,570,8049,554883)
dd2 <- cbind(dd1,counts)
dd2
##Create the cross table using the xtabs function
q2_dat <- xtabs (counts~restrain+Injury, data=dd2)
q2_dat
addmargins(q2_dat)
### Use the prop.table function to compute conditional probabilities by specifying the row (margin=1) or column (margin=2)
prop.table(q2_dat, margin=1)
### prop.test(c(x1,x2), c(ni,n2))
#Enter the count for the groups, then the total for the groups
prop.test(c(433,570),c(8482,555453), conf.level =0.95,correct=FALSE)
### Use the prop.table function to compute conditional probabilities by specifying the row (margin=1) or column (margin=2)
prop.table(q2_dat, margin=1)
pi_hat1=0.051
pi_hat2=0.001
### Relative risk =proportion1/proportion2
RR=pi_hat1/pi_hat2
RR
library (epitools)
#enter the values rowwise
oddsratio(c(433,8049,570,554883),method ="wald", conf.level=0.95, correct=FALSE) #Wald confidence Interval
library(PropCIs)
## This makes use of the x1, n1, and x2, n2
riskscoreci(433,8482,570,555453, conf.level = 0.95)
OR$measure
library (epitools)
#enter the values rowwise
oddsratio(c(433,8049,570,554883),method ="wald", conf.level=0.95, correct=FALSE) #Wald confidence Interval
OR$measure
apha= 0.05
qchisq(1-alpha,3)
alpha= 0.05
qchisq(1-alpha,3)
test_stat_25
test_stat=25
pchisq(test_stat, df=3, lower.tail=FALSE)
data <- read.table("snowgeese.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
View(data)
View(data)
sapply(data, class)
levels(factor(data$Diet))
View(data)
View(data)
names(data)
str(data)
lapply(data, function(x) if(is.factor(x)) levels(x))
names(data)
str(data)
lapply(data, function(x) if(is.factor(x)) levels(x))
names(data)
str(data)
sapply(data, class)
plot(data$DigestionEfficiency, data$WeightChange,
main = "Scatterplot of Weight Change vs Digestion Efficiency",
xlab = "Digestion Efficiency (%)",
ylab = "Weight Change (%)",
pch = 16, col = "blue")
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(data$DigestionEfficiency, # X-variable
data$WeightChange, # Y-variable
main = "Scatterplot of Sale Price vs. Value of a Property",
ylab = "Sale price",
xlab = "Value of a property",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
sum(is.na(data$DigEff))
sum(is.na(data$WtChange))
str(data)
sum(is.na(data$DigEff))
sum(is.na(data$WtChange))
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(data$DigestionEfficiency, # X-variable
data$WeightChange, # Y-variable
main = "Scatterplot of Sale Price vs. Value of a Property",
ylab = "Sale price",
xlab = "Value of a property",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
plot(data$DigestionEfficiency, data$WeightChange,
main = "Scatterplot of Weight Change vs Digestion Efficiency",
xlab = "Digestion Efficiency (%)",
ylab = "Weight Change (%)",
pch = 16, col = "blue")
data$DigEff <- as.numeric(as.character(data$DigEff))
data$WtChange <- as.numeric(as.character(data$WtChange))
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(data$DigestionEfficiency, # X-variable
data$WeightChange, # Y-variable
main = "Scatterplot of Sale Price vs. Value of a Property",
ylab = "Sale price",
xlab = "Value of a property",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
plot(data$DigEff, data$WtChange,
main = "Scatterplot: Weight Change vs Digestion Efficiency",
xlab = "Digestion Efficiency (%)",
ylab = "Weight Change (%)",
pch = 16, col = "blue")
plot(data$DigestionEfficiency, data$WeightChange,
main = "Scatterplot of Weight Change vs Digestion Efficiency",
xlab = "Digestion Efficiency (%)",
ylab = "Weight Change (%)",
pch = 16, col = "blue")
plot(data$DigestionEfficiency, data$WeightChange,
main = "Scatterplot of Weight Change vs Digestion Efficiency",
xlab = "Digestion Efficiency (%)",
ylab = "Weight Change (%)",
pch = 16, col = "blue")
correlation <- cor(data$WtChange, data$DigEff)
cat("Coeficiente de correlaci贸n: ", correlation, "\n")
correlation <- cor(data$WtChange, data$DigEff)
correlation <- cor(data$WtChange, data$DigEff)
correlation <- cor(data$WtChange, data$DigEff)
correlation
cor_test <- cor.test(data$WtChange, data$DigEff, conf.level = 0.99)
cor_test
model <- lm(WtChange ~ DigEff, data = data)
summary(model)
intercept <- coef(model)[1]
slope <- coef(model)[2]
confint(model, level = 0.90)
new_data <- data.frame(DigestionEfficiency = 17)
predict(model, new_data, interval = "confidence", level = 0.90)
new_data <- data.frame(DigEff = 17)
conf_pred <- predict(model, new_data, interval = "confidence", level = 0.90)
print(conf_pred)
pred_interval <- predict(model, new_data, interval = "prediction", level = 0.90)
print(pred_interval)
ggplot(data, aes(x = DigEff, y = WtChange)) +
geom_point(color = "blue") +
geom_smooth(method = "lm", se = TRUE, level = 0.90, color = "red") +
labs(title = "Regresi贸n Lineal con Intervalos de Confianza",
x = "Digestion Efficiency (%)",
y = "Weight Change (%)") +
theme_minimal()
ggplot(data, aes(x = data$DigEff, y = data$WtChange)) +
geom_point(color = "blue") +
geom_smooth(method = "lm", se = TRUE, level = 0.90, color = "red") +
labs(title = "Regresi贸n Lineal con Intervalos de Confianza",
x = "Digestion Efficiency (%)",
y = "Weight Change (%)") +
theme_minimal()
library(ggplot2)
ggplot(data, aes(x = data$DigEff, y = data$WtChange)) +
geom_point(color = "blue") +
geom_smooth(method = "lm", se = TRUE, level = 0.90, color = "red") +
labs(title = "Regresi贸n Lineal con Intervalos de Confianza",
x = "Digestion Efficiency (%)",
y = "Weight Change (%)") +
theme_minimal()
library(ggplot2)
ggplot(data, aes(x = data$DigEff, y = data$WtChange)) +
geom_point(color = "blue") +
geom_smooth(method = "lm", se = TRUE, level = 0.90, color = "red") +
labs(title = "Least squares line with confidence intervals",
x = "Digestion Efficiency (%)",
y = "Weight Change (%)") +
theme_minimal()
r_squared <- summary(model)$r.squared
r_squared
data <- read.table("FHWABRIDGE.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
data <- read.table("FHWABRIDGE.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
data <- read.table("fhwabridge.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
data <- read.table("fhwabridge.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
data <- read.table("snowgeese.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
data <- read.table("fhwabridge.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
data <- read.table("fhwabridge.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
data <- read.table("fhwabridge.txt", header = TRUE, sep = "", stringsAsFactors = FALSE)
data <- read.table("fhwabridge.txt", header = TRUE, sep = "", stringsAsFactors = FALSE)
FHWABRIDGE <- read.delim("C:/Users/sanda/Documents/Langara College/DANA-4810-001/Chapter 3/FHWABRIDGE.txt")
View(FHWABRIDGE)
data <- read.delim("C:/Users/sanda/Documents/Langara College/DANA-4810-001/Chapter 3/FHWABRIDGE.txt")
View(data)
View(data)
x<- data$NumberSD
y<- data$SDArea
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(x, # X-variable
y, # Y-variable
main = "Scatterplot of Sale Price vs. Value of a Property",
ylab = "Total area of the deficient bridges",
xlab = "Number of structurally deficient bridges",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(x, # X-variable
y, # Y-variable
main = "Total area of the deficient bridges vs. Number of structurally deficient bridges",
ylab = "Total area of the deficient bridges",
xlab = "Number of structurally deficient bridges",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(x, # X-variable
y, # Y-variable
main = "Total area vs. Number of structurally deficient bridges",
ylab = "Total area of the deficient bridges",
xlab = "Number of structurally deficient bridges",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
model=lm(y~x)
summary(model)
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(x, # X-variable
y, # Y-variable
main = "Total area vs. Number of structurally deficient bridges",
ylab = "Total area of the deficient bridges",
xlab = "Number of structurally deficient bridges",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
rang_95=2*s
rang_95=2*s
rang_95
confint(model,level=0.95)
rang_95=2*s
rang_95
load ("C:/Users/sanda/Documents/Langara College/DANA-4810-001/Chapter 3/TAMPALMS.Rdata")
y <- TAMPALMS$Sale_Price
x <- TAMPALMS$Market_Val
model=lm(y~x)
summary(model)
confint(model, level=0.99)
confint(model, level=0.99)
confint(model, level=0.99)
confint(model, level=0.95)
confint(model, level=0.99)
confint(model, level=0.95)
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(x, # X-variable
y, # Y-variable
main = "Total area vs. Number of structurally deficient bridges",
ylab = "Total area of the deficient bridges",
xlab = "Number of structurally deficient bridges",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
abline(a = 119.86392, b = 0.34560, col = "red", lwd = 2)
data <- read.delim("C:/Users/sanda/Documents/Langara College/DANA-4810-001/Chapter 3/FHWABRIDGE.txt")
x<- data$NumberSD
y<- data$SDArea
model=lm(y~x)
summary(model)
# Scatterplot or Scatter Diagram
# Note: For 2 variables, X-var goes first in plot()
plot(x, # X-variable
y, # Y-variable
main = "Total area vs. Number of structurally deficient bridges",
ylab = "Total area of the deficient bridges",
xlab = "Number of structurally deficient bridges",
cex = 0.8, # size of the dot
pch = 20, # style of the dot, default is 1
col = "blue")
abline(a = 119.86392, b = 0.34560, col = "red", lwd = 2)
y_length = length(y)
s=sqrt(sum(model$residuals^2)/(y_length-2))
s
rang_95=2*s
rang_95
load ("C:/Users/sanda/Documents/Langara College/DANA-4810-001/Chapter 3/TAMPALMS.Rdata")
load ("C:/Users/sanda/Documents/Langara College/DANA-4810-001/Chapter 3/TAMPALMS.Rdata")
model=lm(y~x)
summary(model)
load ("C:/Users/sanda/Documents/Langara College/DANA-4810-001/Chapter 3/TAMPALMS.Rdata")
y <- TAMPALMS$Sale_Price
x <- TAMPALMS$Market_Val
model=lm(y~x)
summary(model)
confint(model, level=0.95)
Happiness <- c("Not Too Happy", "Pretty Happy", "Very Happy")
Income <- c("Above average", "Average", "Below average")
dat1 <- expand.grid(Happiness=Happiness, Income=Income)
dat1
counts <-c(21,159,110,53,,372,221,94,249,83)
Happiness <- c("Not Too Happy", "Pretty Happy", "Very Happy")
Income <- c("Above average", "Average", "Below average")
dat1 <- expand.grid(Happiness=Happiness, Income=Income)
dat1
counts <-c(21,159,110,53,372,221,94,249,83)
dat2<- cbind(dat1,counts)
dat2
Happiness <- c("Not Too Happy", "Pretty Happy", "Very Happy")
Income <- c("Above average", "Average", "Below average")
dat1 <- expand.grid(Happiness=Happiness, Income=Income)
dat1
counts <-c(21,159,110,53,372,221,94,249,83)
dat2<- cbind(dat1,counts)
dat2
#Create a table using xtabs
q3_dat <- xtabs(counts~Income+Happiness, data =dat2)
q3_dat
chi_test <- chisq.test(q3_dat)
chi_test
library (MASS)
loglm(~Income+Happiness, data=q3_dat)
chi_test$stdres  #print the standardized residuals
chi_test$stdres  #print the standardized residuals
install.packages("vcdExtra")
A= vcdExtra::CMHtest(q3_dat, rscores=c(), cscores=c(), types ="cor")
install.packages("vcdExtra")
# install.packages("vcdExtra")
A= vcdExtra::CMHtest(q3_dat, rscores=c(), cscores=c(), types ="cor")
install.packages("vcdExtra")
A= vcdExtra::CMHtest(q3_dat, rscores=c(), cscores=c(), types ="cor")
install.packages("vcdExtra")
A= vcdExtra::CMHtest(q3_dat, rscores=c(3,2,1), cscores=c(1,2,3), types ="cor")
A
#install.packages("vcdExtra")
A= vcdExtra::CMHtest(q3_dat, rscores=c(3,2,1), cscores=c(1,2,3), types ="cor")
A
#install.packages("vcdExtra")
A= vcdExtra::CMHtest(q3_dat, rscores=c(3,2,1), cscores=c(1,2,3), types ="cor")
A
# Sample correlation R
n=sum(q3_dat)
M_sq=A$table[1]
R=sqrt(M_sq/(n-1))
R # Strength of correlation (missing direction)
data <- read.table("snowgeese.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
names(data)
View(data)
sum(is.na(data$DigEff))
sum(is.na(data$WtChange))
data$DigEff <- as.numeric(as.character(data$DigEff))
data$WtChange <- as.numeric(as.character(data$WtChange))
plot(data$DigEff, data$WtChange,
main = "Scatterplot: Weight Change vs Digestion Efficiency",
xlab = "Digestion Efficiency (%)",
ylab = "Weight Change (%)",
pch = 16, col = "blue")
plot(data$DigEff, data$WtChange,
main = "Scatterplot: Weight Change vs Digestion Efficiency",
xlab = "Digestion Efficiency",
ylab = "Weight Change",
pch = 16, col = "blue")
cor_test <- cor.test(data$WtChange, data$DigEff, conf.level = 0.99)
cor_test
confint(model, level = 0.90)
model <- lm(WtChange ~ DigEff, data = data)
summary(model)
intercept <- coef(model)[1]
slope <- coef(model)[2]
confint(model, level = 0.90)
confint(model, level = 0.90)
model <- lm(WtChange ~ DigEff, data = data)
summary(model)
intercept <- coef(model)[1]
slope <- coef(model)[2]
confint(model, level = 0.90)
new_data <- data.frame(DigEff = 17)
conf_pred <- predict(model, new_data, interval = "confidence", level = 0.90)
print(conf_pred)
new_data <- data.frame(DigEff = 17)
conf_pred <- predict(model, new_data, interval = "confidence", level = 0.90)
print(conf_pred)
new_data <- data.frame(DigEff = 17)
conf_pred <- predict(model, new_data, interval = "confidence", level = 0.90)
print(conf_pred)
pred_interval <- predict(model, new_data, interval = "prediction", level = 0.90)
print(pred_interval)
plot(
data$DigEff,
data$WtChange,
main = "Regression Line with Confidence and Prediction Intervals",
xlab = "Digestive Efficiency (%)",
ylab = "Weight Change (%)",
pch = 19,
col = "blue"
)
abline(lm_model, col = "red", lwd = 2)
plot(
data$DigEff,
data$WtChange,
main = "Regression Line with Confidence and Prediction Intervals",
xlab = "Digestive Efficiency (%)",
ylab = "Weight Change (%)",
pch = 19,
col = "blue"
)
abline(model, col = "red", lwd = 2)
dig_eff_seq <- seq(min(data$DigEff), max(data$DigEff), length.out = 100)
pred_values <- data.frame(DigEff = dig_eff_seq)
conf_band <- predict(lm_model, newdata = pred_values, interval = "confidence", level = 0.90)
plot(
data$DigEff,
data$WtChange,
main = "Regression Line with Confidence and Prediction Intervals",
xlab = "Digestive Efficiency (%)",
ylab = "Weight Change (%)",
pch = 19,
col = "blue"
)
abline(model, col = "red", lwd = 2)
dig_eff_seq <- seq(min(data$DigEff), max(data$DigEff), length.out = 100)
pred_values <- data.frame(DigEff = dig_eff_seq)
conf_band <- predict(model, newdata = pred_values, interval = "confidence", level = 0.90)
pred_band <- predict(model, newdata = pred_values, interval = "prediction", level = 0.90)
lines(dig_eff_seq, conf_band[,2], col = "green", lty = 2)
lines(dig_eff_seq, conf_band[,3], col = "green", lty = 2)
lines(dig_eff_seq, pred_band[,2], col = "purple", lty = 2)
lines(dig_eff_seq, pred_band[,3], col = "purple", lty = 2)
legend("topleft", legend = c("Regression Line", "Confidence Interval", "Prediction Interval"),
col = c("red", "green", "purple"), lty = c(1,2,2), bty = "n")
plot(
data$DigEff,
data$WtChange,
main = "Regression Line with Confidence and Prediction Intervals",
xlab = "Digestive Efficiency (%)",
ylab = "Weight Change (%)",
pch = 19,
col = "blue"
)
abline(model, col = "red", lwd = 2)
dig_eff_seq <- seq(min(data$DigEff), max(data$DigEff), length.out = 100)
pred_values <- data.frame(DigEff = dig_eff_seq)
conf_band <- predict(model, newdata = pred_values, interval = "confidence", level = 0.90)
pred_band <- predict(model, newdata = pred_values, interval = "prediction", level = 0.90)
lines(dig_eff_seq, conf_band[,2], col = "green", lty = 2)
lines(dig_eff_seq, conf_band[,3], col = "green", lty = 2)
lines(dig_eff_seq, pred_band[,2], col = "purple", lty = 2)
lines(dig_eff_seq, pred_band[,3], col = "purple", lty = 2)
legend("topleft", legend = c("Regression Line", "Confidence Interval", "Prediction Interval"),
col = c("red", "green", "purple"), lty = c(1,2,2), bty = "n", inset = 0.05)
