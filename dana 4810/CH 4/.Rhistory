prop.test(c(189, 104), c(11034, 11037),conf.level = 0.95, correct = FALSE)
#score confidence intervals π1 − π2
library(PropCIs)
diffscoreci(189, 11034, 104, 11037, conf.level=0.95)
#score CI for relative risk
library(PropCIs)
riskscoreci(189, 11034, 104, 11037, conf.level=0.95)
## Wald CI for odds ratio, no continuity correction uses the four cell counts
install.packages("epitools")
library(epitools)
oddsratio(c(189,10845,104,10933), method="wald", conf=0.95, correct=FALSE)
# score CI for odds ratio uses success count and n for each binomial group
library(PropCIs)
orscoreci(189, 11034, 104, 11037, conf.level=0.95)
x <- seq(0,40, length=1000)
h1 <- dchisq(x, 1)
plot(x, h1, type="l", lty=1, xlab="Chi-Squared",
ylab="Probability Density", main="Chi-Squared Distributions", col="green", ylim=c(0,0.18))
h2= dchisq(x,5)
lines(x, h2, col="red", lty=1)
h3= dchisq(x,10)
lines(x, h3, col="yellow", lty=1)
h4= dchisq(x,20)
lines(x, h4, col="blue", lty=1)
legend("topright",c("df=1","df=5", "df=10","df=20"), lty=c(1, 1,1,1), col=c("green", "red", "yellow", "blue"))
Political <- read.table("Political.dat", header = TRUE)
View(Political)
attach(Political)
gen_par=Political[-c(1)]
gen_par
#Forms contingency table
Counts=table(gen_par)
Counts
#or
GenderGap <- xtabs(~gender + party, data=Political)
GenderGap
#Adding Totals
addmargins(Counts)
#Row Proportions with (Row=1, Column=2)
prop.table(Counts,margin = 1)
#Table with column percents
Column_percent =(prop.table(Counts,margin = 2)*100)
Column_percent
#Side-By-Side Bar graph by Flexibility
barplot(height =Column_percent , beside=TRUE,
col=c("red","blue"),legend.text = TRUE,
args.legend = list(x="topright"), ylim=c(0,150),
xlab="Political Party Identification",
ylab="Percent",
main = "Side-By-Side Bar graph for Gender by Political Party")
#Chi-Square test
test=chisq.test(Counts)
test
#Observed and Expected Counts
Obesrved=test$observed
Obesrved
Expected=test$expected
Expected
#Individual cell contribution
cont=(Obesrved-Expected)^2/Expected
cont
# standardized residuals
stdres <- test$stdres
stdres
#Likelihood-Ratio Statistic
library(MASS)
loglm(~gender + party, data=GenderGap)
#Mosaic plot
#install.packages("vcd")
#install.packages("grid")
library(grid)
library(vcd)
mosaic(GenderGap, gp=shading_Friendly,  residuals=stdres,
residuals_type="Std\nresiduals", labeling=labeling_residuals)
Malform <- c(17066, 14464, 788, 126, 37, 48, 38, 5, 1, 1)
Malform.table <- as.table(matrix(Malform, nrow = 5, byrow = FALSE,
dimnames = list(Alcohol.Consumption= c('0', '< 1', '1-2', '3-5', '>= 6'),
Malformation = c('Absent', 'Present'))))
Malform.table
#Adding Totals
addmargins(Malform.table)
# Testing the linear trend
#install.packages("vcdExtra")
library(vcdExtra)
A=CMHtest(Malform.table, rscores = c(0, 0.5, 1.5, 4.0, 7.0), cscores=0:1, types="cor")
A
#Sample correlation R
n=sum(Malform.table)
n
M=sqrt(A$table[1])
M
R=M/sqrt(n)
R
#P-value for one-sided standard normal with M statistic
P_value=pnorm(M, lower.tail = FALSE)
P_value
tea <- matrix(c(3,1,1,3), ncol=2)
# two-sided Fisher's Exact Test
fisher.test(tea)
#one-sided alternative hypothesis: true odds ratio is not equal to 1
fisher.test(tea, alternative = "greater")
#Mid P-values for testing independence
library(epitools)
ormidp.test(3, 1, 1, 3, or=1)
#mid-P confidence interval for odds ratio
or.midp(c(3, 1, 1, 3), conf.level=0.95)$conf.int
###Hypergeometric distribution, x, m=#S,n=#F, k=n
p_3= dhyper(3,4,4,4)
p_3
p_4= dhyper(4,4,4,4)
p_4
p_value=1-phyper(2,4,4,4)
p_value
####
n11=c(0,1,2,3,4)
##Example
dhyper(0,4,6,3)
##Hypergeometric function
n11=c(0,1,2,3,4)
p_3= dhyper(3,4,4,4)
p_value=1-phyper(2,4,4,4)
p_p_value <- function(x)
{
p_x <- c("Probability"=dhyper(x,4,4,4),
"p-value"=1-phyper(x-1,4,4,4))
return(p_x)
}
p_p_value(n11)
cbind(n11,"Probability" = p_p_value(n11)[1:5], "P -value"=p_p_value(n11)[6:10] )
#### Sensitivity =True positive rate = P(positive|Yes)=0.99
### Specificity = True negative rate = P(negative|No)=0.99
### PPV = P(Yes|Positive) = P(Yes and Positive)/P(Positive)
p_yes=0.008
p_no=1-p_yes
#### Sensitivity =True positive rate = P(positive|Yes)=0.99
### Specificity = True negative rate = P(negative|No)=0.99
### PPV = P(Yes|Positive) = P(Yes and Positive)/P(Positive)
### PPV = P(Positive|Yes)*P(Yes)/[P(Positive|Yes)*P(Yes)+P(Positive|No)*P(No)]
p_yes=0.008
p_no=1-p_yes
p-posyes = 0.99
#### Sensitivity =True positive rate = P(positive|Yes)=0.99
### Specificity = True negative rate = P(negative|No)=0.99
### PPV = P(Yes|Positive) = P(Yes and Positive)/P(Positive)
### PPV = P(Positive|Yes)*P(Yes)/[P(Positive|Yes)*P(Yes)+P(Positive|No)*P(No)]
p_yes=0.008
p_no=1-p_yes
p_posyes = 0.99
p_negno = 0.99
p_posno =1-negno
#### Sensitivity =True positive rate = P(positive|Yes)=0.99
### Specificity = True negative rate = P(negative|No)=0.99
### PPV = P(Yes|Positive) = P(Yes and Positive)/P(Positive)
### PPV = P(Positive|Yes)*P(Yes)/[P(Positive|Yes)*P(Yes)+P(Positive|No)*P(No)]
p_yes=0.008
p_no=1-p_yes
p_posyes = 0.99
p_negno = 0.99
p_posno =1-p_negno
PPV=(p_posyes*p_yes)/((p_posyez*P_yes)+(p_posno*p_no))
#### Sensitivity =True positive rate = P(positive|Yes)=0.99
### Specificity = True negative rate = P(negative|No)=0.99
### PPV = P(Yes|Positive) = P(Yes and Positive)/P(Positive)
### PPV = P(Positive|Yes)*P(Yes)/[P(Positive|Yes)*P(Yes)+P(Positive|No)*P(No)]
p_yes=0.008
p_no=1-p_yes
p_posyes = 0.99
p_negno = 0.99
p_posno =1-p_negno
PPV=(p_posyes*p_yes)/((p_posyes*P_yes)+(p_posno*p_no))
#### Sensitivity =True positive rate = P(positive|Yes)=0.99
### Specificity = True negative rate = P(negative|No)=0.99
### PPV = P(Yes|Positive) = P(Yes and Positive)/P(Positive)
### PPV = P(Positive|Yes)*P(Yes)/[P(Positive|Yes)*P(Yes)+P(Positive|No)*P(No)]
p_yes=0.008
p_no=1-p_yes
p_posyes = 0.99
p_negno = 0.99
p_posno =1-p_negno
PPV=(p_posyes*p_yes)/((p_posyes*p_yes)+(p_posno*p_no))
PPV
dat<-matrix(c(433,570,8049,554883), ncol =2, nrow =2, byrow =FALSE)
rowname(dat)<- c("No", "Yes")
dat<-matrix(c(433,570,8049,554883), ncol =2, nrow =2, byrow =FALSE)
rownames(dat)<- c("No", "Yes")
colnames(dat)<- c("Fatal", "Nonfatal")
addmargins(dat) ##add the total
restrain <- c("No", "Yes")
Injury <- c("Fatal", "Nonfatal")
dd1 <- expand.grid(restrain=restrain, Injury=Injury)
dd1
restrain <- c("No", "Yes")
Injury <- c("Fatal", "Nonfatal")
dd1 <- expand.grid(restrain=restrain, Injury=Injury)
dd1
counts <- c(433,570,8049,554883)
dd2 <- cbind(dd1,counts)
dd2
##Create the cross table using the xtabs function
q2_dat <- xtabs (counts~restrain+Injury, data=dd2)
q2_dat
restrain <- c("No", "Yes")
Injury <- c("Fatal", "Nonfatal")
dd1 <- expand.grid(restrain=restrain, Injury=Injury)
dd1
counts <- c(433,570,8049,554883)
dd2 <- cbind(dd1,counts)
dd2
##Create the cross table using the xtabs function
q2_dat <- xtabs (counts~restrain+Injury, data=dd2)
q2_dat
addmargins(q2_dat)
Clinic <- c("1", "2")
Response <- c("Success", "Failure")
Drug.Treatment <- c("A","B")
dat_tab <- expand.grid(Drug.Treatment=Drug.Treatment,
Clinic=Clinic,
Response=Response)
counts <- c(18,1,2,8,12,8,8,32)
data<-cbind(dat_tab,counts)
data
#Create a table using xtabs
#q3_dat <- xtabs(counts~Income+Happiness, data =dat2)
#q3_dat
Clinic <- c("1", "2")
Response <- c("Success", "Failure")
Drug.Treatment <- c("A","B")
dat_tab <- expand.grid(Drug.Treatment=Drug.Treatment,
Clinic=Clinic,
Response=Response)
counts <- c(18,12,2,8,12,8,8,32)
data<-cbind(dat_tab,counts)
data
#Create a table using xtabs
#q3_dat <- xtabs(counts~Income+Happiness, data =dat2)
#q3_dat
#Create a table using xtabs
tab1 <- xtabs(counts~Drug.Treatment+Responses, Clinic=="1" data =data)
#Create a table using xtabs
tab1 <- xtabs(counts~Drug.Treatment+Responses, Clinic=="1", data =data)
#Create a table using xtabs
tab1 <- xtabs(counts~Drug.Treatment +R esponses, Clinic=="1", data =data)
#Create a table using xtabs
tab1 <- xtabs(counts~Drug.Treatment + Responses, Clinic=="1", data =data)
#Create a table using xtabs
tab1 <- xtabs(counts~Drug.Treatment + Response, Clinic=="1", data =data)
tab1
epitools::oddsratio(tab1, method="wald", conf =0.95, correct=FALSE)
#Create a table using xtabs
tab2 <- xtabs(counts~Drug.Treatment + Response, Clinic=="2", data =data)
tab2
epitools::oddsratio(tab2, method="wald", conf =0.95, correct=FALSE)
#Create a table using xtabs
tab3 <- xtabs(counts~Drug.Treatment + Response, data =data)
tab3
epitools::oddsratio(tab3, method="wald", conf =0.95, correct=FALSE)
epitools::oddsratio(tab2, method="wald", conf =0.95, correct=FALSE)
setwd("C:/Users/sanda/Documents/Langara College/DANA-4810-001/CH 4")
data <- read.table("gasturbine.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
View(data)
pairs(~HEATRATE+RPM+CPRATIO+INLET.TEMP+EXH.TEMP+AIRFLOW, data = GASTURBINE,
main="Scatterplot Matrix of Gas Turbines")
GASTURBINE <- read.table("gasturbine.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
pairs(~HEATRATE+RPM+CPRATIO+INLET.TEMP+EXH.TEMP+AIRFLOW, data = GASTURBINE,
main="Scatterplot Matrix of Gas Turbines")
model413 <- lm(HEATRATE ~ RPM + CPRATIO + INLET.TEMP + EXH.TEMP + AIRFLOW, data = GASTURBINE)
summary(model413)
pairs(~HEATRATE+RPM+CPRATIO+INLET.TEMP+EXH.TEMP+AIRFLOW, data = GASTURBINE,
main="Scatterplot Matrix of Gas Turbines")
model413 <- lm(HEATRATE ~ RPM + CPRATIO + INLET.TEMP + EXH.TEMP + AIRFLOW, data = GASTURBINE)
summary(model413)
anova(model1413)
anova(model413)
New <- data.frame(RPM = c(7500), CPRATIO = c(13.5), INLET.TEMP = c(1000),
EXH.TEMP = c(525), AIRFLOW = c(10))
predict(model413, New)
predict(model413, New, interval = "confidence", level = 0.95)
predict(model413, New, interval = "prediction", level = 0.95)
model <- lm(HEATRATE ~ INLET.TEMP + EXH.TEMP + INLET.TEMP:AIRFLOW + EXH.TEMP:AIRFLOW,
data = GASTURBINE)
summary(model)
model <- lm(HEATRATE ~ INLET.TEMP + EXH.TEMP + INLET.TEMP:AIRFLOW + EXH.TEMP:AIRFLOW,
data = GASTURBINE)
summary(model)
model1432 <- lm(HEATRATE ~ INLET.TEMP + EXH.TEMP + INLET.TEMP * AIRFLOW + EXH.TEMP * AIRFLOW,
data = GASTURBINE)
summary(model1432)
CARP <- read.table("carp.txt", header = TRUE, sep = "", stringsAsFactors = TRUE)
modelQuad <- lm(ENE ~ WEIGHT + I(WEIGHT^2))
View(CARP)
modelQuad <- lm(ENE ~ WEIGHT + I(WEIGHT^2), data=CARP)
summary(modelQuad)
# Load data
CARP <- read.table("GFCLOCKS.txt", header = TRUE, sep = "", stringsAsFactors = FALSE)
library(ggplot2)
library(dplyr)
# Scatterplot: Price vs Age
ggplot(CARP, aes(x = AGE, y = PRICE)) +
geom_point() +
labs(title = "Scatterplot: Price vs Age", x = "Age of Clock", y = "Auction Price")
# Scatterplot: Price vs Number of Bidders
ggplot(CARP, aes(x = NUMBIDS, y = PRICE)) +
geom_point() +
labs(title = "Scatterplot: Price vs Number of Bidders", x = "Number of Bidders", y = "Auction Price")
library(ggplot2)
library(dplyr)
# Scatterplot: Price vs Age
ggplot(CARP, aes(x = AGE, y = PRICE)) +
geom_point() +
labs(title = "Scatterplot: Price vs Age", x = "Age of Clock", y = "Auction Price")
# Scatterplot: Price vs Number of Bidders
ggplot(CARP, aes(x = NUMBIDS, y = PRICE)) +
geom_point() +
labs(title = "Scatterplot: Price vs Number of Bidders", x = "Number of Bidders", y = "Auction Price")
model <- lm(PRICE ~ AGE + NUMBIDS, data = CARP)
summary(model)
SSE <- sum(resid(model)^2)
SSE
MSE <- SSE / df.residual(model)
MSE
Root_MSE <- sqrt(MSE)
Root_MSE
MSE <- SSE / df.residual(model)
MSE
Root_MSE <- sqrt(MSE)
Root_MSE
anova(model)
summary(model)$coefficients["NUMBIDS", ]
confint(model, level = 0.95)
new_data <- data.frame(AGE = 150, NUMBIDS = 10)
predict(model, new_data, interval = "confidence", level = 0.95)
predict(model, new_data, interval = "prediction", level = 0.95)
new_data2 <- data.frame(AGE = 50, NUMBIDS = 2)
predict(model, new_data2, interval = "prediction", level = 0.95)
model_interaction <- lm(PRICE ~ AGE * NUMBIDS, data = CARP)
summary(model_interaction)
anova(model)
summary(model_interaction)$coefficients["AGE:NUMBIDS", ]
summary(model)$coefficients["NUMBIDS", ]
GFCLOCKS <- read.table("GFCLOCKS.txt", header = TRUE, sep = "", stringsAsFactors = FALSE)
View(GFCLOCKS)
View(GFCLOCKS)
plot(GFCLOCKS$AGE, GFCLOCKS$PRICE,
main = "Scatterplot: Price vs Age",
xlab = "Age",
ylab = "Price ($)",
pch = 16, col = "blue")
plot(GFCLOCKS$AGE, GFCLOCKS$PRICE,
main = "Scatterplot: Price vs Age",
xlab = "Age",
ylab = "Price ($)",
pch = 16, col = "blue")
plot(GFCLOCKS$NUMBIDS, GFCLOCKS$PRICE,
main = "Scatterplot: Price vs Number of bidders",
xlab = "Number of bidders",
ylab = "Price ($)",
pch = 16, col = "blue")
modelA1 <- lm(PRICE ~ AGE + NUMBIDS, data = GFCLOCKS)
summary(modelA1)
SSE <- sum(resid(modelA1)^2)
SSE
anova(modelA1)
pairs(~PRICE+AGE+NUMBIDS, data = GFCLOCKS,
main="Scatterplot Matrix of Price clocks")
SSE=516727
n=32
k=2
MSE=SSE/(n-(k+1))
MSE
SE= sqrt(MSE)
ME= sqrt(MSE)
ME
SSE=516727
n=32
k=2
MSE=SSE/(29)
MSE
SSE=516727
n=32
k=2
MSE=SSE/(n-(k+1))
MSE
ME= sqrt(MSE)
ME
summary(model)$coefficients["NUMBIDS", ]
confint(model, level = 0.95)
