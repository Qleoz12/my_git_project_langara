---
title: "Ejercicios DANA 4810"
author: "Maria Sandate"
date: "2025-02-06"
output: html_document
---

### Escenario: Predicci贸n del Consumo de Combustible

Vamos a trabajar con un conjunto de datos que simula el consumo de combustible de autom贸viles en funci贸n de:

Peso del auto (kg)
Velocidad (km/h)
Potencia del motor (HP)
Utilizaremos un modelo de regresi贸n m煤ltiple para predecir el consumo de combustible (litros por 100 km).

####Paso 1: Generar los datos en R
Primero, creamos datos simulados en R:

```{r}
# Cargar librer铆as necesarias
library(ggplot2)

# Generar datos simulados
set.seed(123)
n <- 100  # n煤mero de observaciones

peso <- rnorm(n, mean = 1500, sd = 200)  # Peso del auto (kg)
velocidad <- rnorm(n, mean = 100, sd = 15)  # Velocidad del auto (km/h)
potencia <- rnorm(n, mean = 150, sd = 30)  # Potencia del motor (HP)

# Generar consumo de combustible con una relaci贸n lineal + ruido
consumo <- 8 + 0.002*peso + 0.01*velocidad - 0.005*potencia + rnorm(n, sd = 1.5)

# Crear DataFrame
datos <- data.frame(peso, velocidad, potencia, consumo)

# Ver los primeros datos
head(datos)
```
#### Paso 2: Ajustar un modelo de regresi贸n m煤ltiple en R
Ahora ajustamos el modelo usando la funci贸n lm():

```{r}
# Ajustar el modelo de regresi贸n m煤ltiple
modelo <- lm(consumo ~ peso + velocidad + potencia, data = datos)

# Resumen del modelo
summary(modelo)
```

#### Paso 4: Diagn贸stico del modelo
Para evaluar si las suposiciones de regresi贸n se cumplen, generamos gr谩ficos de diagn贸stico:

```{r}
# Diagn贸stico del modelo
par(mfrow=c(2,2))  # Dividir el 谩rea gr谩fica en 4 partes
plot(modelo)
```

#### Paso 5: Predicci贸n con el modelo
Supongamos que queremos predecir el consumo de combustible para un auto con:

Peso = 1600 kg
Velocidad = 110 km/h
Potencia = 170 HP

```{r}
# Datos nuevos para predicci贸n
nuevos_datos <- data.frame(peso = 1600, velocidad = 110, potencia = 170)

# Predicci贸n del consumo
predict(modelo, newdata = nuevos_datos, interval = "prediction")
```

#### Modelo extendido

```{r}
# Ajustar modelo con t茅rminos cuadr谩ticos e interacciones
modelo_completo <- lm(consumo ~ peso + I(peso^2) + velocidad + I(velocidad^2) + 
                      potencia + I(potencia^2) + 
                      peso:velocidad + peso:potencia + velocidad:potencia, 
                      data = datos)

# Resumen del nuevo modelo
summary(modelo_completo)
```

#### Eliminar variables innecesarias (simplificaci贸n del modelo)

Usar stepwise para seleccionar solo las variables m谩s relevantes:

```{r}
modelo_step <- step(modelo_completo, direction = "both")
summary(modelo_step)
```
#### Probar transformaciones en la variable dependiente

```{r}
modelo_log <- lm(log(consumo) ~ peso + velocidad + potencia, data = datos)
summary(modelo_log)
```

