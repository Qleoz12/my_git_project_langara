---
title: "Chapter 4 Activity"
author: "Maria Sandate"
date: "2025-01-30"
output:
  word_document: default
  html_document: default
---

# **In-Class Activity: Chapter 4**

A collector of antique grandfather clocks sold at auction believes that the price received for the clocks depends on both the age of the clocks and the number of bidders at the auction. A sample of 32 auction prices of grandfather clocks, along with their age and the number of bidders, is given in GFCLOCKS.

```{r}
# Load data
CARP <- read.table("GFCLOCKS.txt", header = TRUE, sep = "", stringsAsFactors = FALSE)

```



## **(a) Use scattergrams to plot the sample data. Interpret the plots.**
```{r}
library(ggplot2)
library(dplyr)


# Scatterplot: Price vs Age
ggplot(CARP, aes(x = AGE, y = PRICE)) +
  geom_point() +
  labs(title = "Scatterplot: Price vs Age", x = "Age of Clock", y = "Auction Price")
```


```{r}
# Scatterplot: Price vs Number of Bidders
ggplot(CARP, aes(x = NUMBIDS, y = PRICE)) +
  geom_point() +
  labs(title = "Scatterplot: Price vs Number of Bidders", x = "Number of Bidders", y = "Auction Price")
```



## **(b) Use the method of least squares to estimate the unknown parameters β0, β1, and β2 of the model.**
```{r}
model <- lm(PRICE ~ AGE + NUMBIDS, data = CARP)
summary(model)
```



## **(c) Find the value of SSE that is minimized by the least squares method.**
```{r}
SSE <- sum(resid(model)^2)
SSE
```



## **(d) Find the MSE (mean square error) and Root MSE. What is the root MSE?**
```{r}
MSE <- SSE / df.residual(model)
MSE
Root_MSE <- sqrt(MSE)
Root_MSE
```



## **(e) Is the regression model appropriate here? Write down the null and alternative hypothesis and make your conclusion based on the appropriate test.**
```{r}
anova(model)
```
**Null Hypothesis (H0):** The model is not significant.

**Alternative Hypothesis (HA):** At least one predictor significantly affects the auction price.



## **(f) Test the hypothesis that the mean auction price of a clock increases as the number of bidders increases when age is held constant.**
```{r}
summary(model)$coefficients["NUMBIDS", ]
```



## **(g) Form a 95% confidence interval for β1 and interpret the result.**
```{r}
confint(model, level = 0.95)
```



## **(h) Estimate the average auction price for all 150-year-old clocks sold at auctions with 10 bidders using a 95% confidence interval. Interpret the result.**

```{r}
new_data <- data.frame(AGE = 150, NUMBIDS = 10)
predict(model, new_data, interval = "confidence", level = 0.95)
```



## **(i) Predict the auction price for a single 150-year-old clock sold at an auction with 10 bidders using a 95% prediction interval. Interpret the result.**

```{r}
predict(model, new_data, interval = "prediction", level = 0.95)
```



## **(j) Suppose you want to predict the auction price for one clock that is 50 years old and has two bidders. How should you proceed?**

```{r}
new_data2 <- data.frame(AGE = 50, NUMBIDS = 2)
predict(modelA1, new_data2, interval = "prediction", level = 0.95)
```



## **(k) Test the hypothesis that age and number of bidders interact positively.**
```{r}
model_interaction <- lm(PRICE ~ AGE * NUMBIDS, data = CARP)
summary(model_interaction)
```



## **(l) Test the overall utility of the model using the global F-test at α = .05.**
```{r}
anova(model_interaction)
```

Since the p-values for all terms are far below 0.05, we reject the null hypothesis and conclude that the model is statistically useful for predicting auction prices.
Overall, the model provides a strong fit, meaning that AGE, NUMBIDS, and their interaction significantly contribute to explaining auction prices.



## **(m) Test the hypothesis (at α = .05) that the price–age slope increases as the number of bidders increases—that is, that age and number of bidders, x2, interact positively.**

```{r}
summary(model_interaction)$coefficients["AGE:NUMBIDS", ]
```



## **(n) Estimate the change in auction price of a 150-year-old grandfather clock, y, for each additional bidder.**
```{r}
summary(model)$coefficients["NUMBIDS", ]
```

